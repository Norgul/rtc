(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();class g{constructor(t,s,e){this.canvasContext=t,this.width=s,this.height=e}apply(t=1){const s=this.canvasContext.getImageData(0,0,this.width,this.height),e=s.data;for(let i=0;i<e.length;i+=4){const r=(e[i]+e[i+1]+e[i+2])/3;e[i]=e[i]*(1-t)+r*t,e[i+1]=e[i+1]*(1-t)+r*t,e[i+2]=e[i+2]*(1-t)+r*t}this.canvasContext.putImageData(s,0,0)}}class u{constructor(t,s,e){this.canvasContext=t,this.width=s,this.height=e}apply(t=1){const s=this.canvasContext.getImageData(0,0,this.width,this.height),e=s.data;for(let i=0;i<e.length;i+=4){const r=e[i],a=e[i+1],o=e[i+2],l=Math.min(255,r*.393+a*.769+o*.189),c=Math.min(255,r*.349+a*.686+o*.168),d=Math.min(255,r*.272+a*.534+o*.131);e[i]=r*(1-t)+l*t,e[i+1]=a*(1-t)+c*t,e[i+2]=o*(1-t)+d*t}this.canvasContext.putImageData(s,0,0)}}class h{constructor(t,s,e,i=3){if(this.width=s,this.height=e,this.maxRadius=i,this.canvas=document.createElement("canvas"),this.canvas.width=s,this.canvas.height=e,this.gl=this.canvas.getContext("webgl",{preserveDrawingBuffer:!0}),this.outputCanvas=document.createElement("canvas"),this.outputCanvas.width=s,this.outputCanvas.height=e,this.outputContext=this.outputCanvas.getContext("2d"),!this.gl)throw new Error("WebGL not supported");this.program=this.createShaderProgram(),this.vertexBuffer=this.createVertexBuffer(),this.textureCoordBuffer=this.createTextureCoordBuffer(),this.texture=this.createTexture(),this.tempTexture=this.createTexture(),this.framebuffer=this.createFramebuffer(this.tempTexture),this.gl.viewport(0,0,s,e)}compileShader(t,s){const e=this.gl.createShader(s);if(this.gl.shaderSource(e,t),this.gl.compileShader(e),!this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS)){const i=this.gl.getShaderInfoLog(e);throw new Error(`Shader compilation error: ${i}`)}return e}createShaderProgram(){const t=this.compileShader(`
            attribute vec4 aVertexPosition;
            attribute vec2 aTextureCoord;
            varying highp vec2 vTextureCoord;
            void main(void) {
                gl_Position = aVertexPosition;
                vTextureCoord = aTextureCoord;
            }
        `,this.gl.VERTEX_SHADER),s=this.compileShader(`
            precision highp float;
            varying highp vec2 vTextureCoord;
            uniform sampler2D uSampler;
            uniform vec2 uResolution;
            uniform float uRadius;
            uniform bool uHorizontal;

            void main(void) {
                vec2 texel = 1.0 / uResolution;
                vec4 color = vec4(0.0);
                float total = 0.0;
                
                // Use a constant loop range and scale the weight based on radius
                for(int i = -20; i <= 20; i++) {
                    float weight = exp(-float(i * i) / (2.0 * uRadius * uRadius));
                    vec2 offset = uHorizontal ? vec2(float(i) * texel.x, 0.0) : vec2(0.0, float(i) * texel.y);
                    color += texture2D(uSampler, vTextureCoord + offset) * weight;
                    total += weight;
                }
                
                gl_FragColor = color / total;
            }
        `,this.gl.FRAGMENT_SHADER),e=this.gl.createProgram();if(this.gl.attachShader(e,t),this.gl.attachShader(e,s),this.gl.linkProgram(e),!this.gl.getProgramParameter(e,this.gl.LINK_STATUS)){const i=this.gl.getProgramInfoLog(e);throw new Error(`Program linking error: ${i}`)}return this.gl.deleteShader(t),this.gl.deleteShader(s),e}createVertexBuffer(){const t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.gl.STATIC_DRAW),t}createTextureCoordBuffer(){const t=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,1,1,1,0,0,1,0]),this.gl.STATIC_DRAW),t}createTexture(){const t=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(this.width*this.height*4)),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),t}createFramebuffer(t){const s=this.gl.createFramebuffer();if(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,s),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,t,0),this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER)!==this.gl.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete");return s}apply(t=1){if(t<=0)return;const s=Math.floor(this.maxRadius*t);if(s<=0)return;this.gl.useProgram(this.program);const e=this.gl.getAttribLocation(this.program,"aVertexPosition"),i=this.gl.getAttribLocation(this.program,"aTextureCoord");if(e===-1||i===-1)throw new Error("Failed to get attribute locations");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.textureCoordBuffer),this.gl.enableVertexAttribArray(i),this.gl.vertexAttribPointer(i,2,this.gl.FLOAT,!1,0,0);const r=this.gl.getUniformLocation(this.program,"uResolution"),a=this.gl.getUniformLocation(this.program,"uRadius"),o=this.gl.getUniformLocation(this.program,"uHorizontal");if(!r||!a||!o)throw new Error("Failed to get uniform locations");this.gl.uniform2f(r,this.width,this.height),this.gl.uniform1f(a,s),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer),this.gl.uniform1i(o,1),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.uniform1i(o,0),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.outputContext.clearRect(0,0,this.width,this.height),this.outputContext.drawImage(this.canvas,0,0)}updateSource(t){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t)}getOutputCanvas(){return this.outputCanvas}dispose(){this.gl&&(this.gl.deleteTexture(this.texture),this.gl.deleteTexture(this.tempTexture),this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.textureCoordBuffer),this.gl.deleteFramebuffer(this.framebuffer),this.gl.deleteProgram(this.program),this.canvas.width=1,this.canvas.height=1,this.outputCanvas.width=1,this.outputCanvas.height=1)}}class m{constructor(t,s,e){this.canvasContext=t,this.width=s,this.height=e}apply(t=1){const s=this.canvasContext.getImageData(0,0,this.width,this.height),e=s.data;for(let i=0;i<e.length;i+=4){const r=255-e[i],a=255-e[i+1],o=255-e[i+2];e[i]=e[i]*(1-t)+r*t,e[i+1]=e[i+1]*(1-t)+a*t,e[i+2]=e[i+2]*(1-t)+o*t}this.canvasContext.putImageData(s,0,0)}}class f{constructor(t,s,e){this.filters={grayscale:null,sepia:null,blur:null,invert:null},this.canvasContext=t,this.width=s,this.height=e,this.tempCanvas=document.createElement("canvas"),this.tempCanvas.width=s,this.tempCanvas.height=e,this.tempContext=this.tempCanvas.getContext("2d"),this.initializeFilters(),this.initializeIntensitySliders(),this.enableAllButtons()}initializeFilters(){this.filters.grayscale=new g(this.tempContext,this.width,this.height),this.filters.sepia=new u(this.tempContext,this.width,this.height),this.filters.blur=new h(this.tempContext,this.width,this.height),this.filters.invert=new m(this.tempContext,this.width,this.height)}initializeIntensitySliders(){this.intensitySliders={grayscale:document.getElementById("grayscaleIntensity"),sepia:document.getElementById("sepiaIntensity"),blur:document.getElementById("blurIntensity"),invert:document.getElementById("invertIntensity")},this.blurRadiusSlider=document.getElementById("blurRadius"),this.blurRadiusSlider.addEventListener("input",()=>{if(this.filters.blur){const t=parseInt(this.blurRadiusSlider.value);this.filters.blur.dispose(),this.filters.blur=new h(this.tempContext,this.width,this.height,t)}})}applyFilters(){this.tempContext.drawImage(this.canvasContext.canvas,0,0),Object.entries(this.filters).forEach(([t,s])=>{if(!s)return;const e=parseInt(this.intensitySliders[t].value)/100;e>0&&(t==="blur"?(s.updateSource(this.tempCanvas),s.apply(e),this.tempContext.drawImage(s.getOutputCanvas(),0,0)):s.apply(e))}),this.canvasContext.drawImage(this.tempCanvas,0,0)}enableAllButtons(){Object.values(this.intensitySliders).forEach(t=>{t.disabled=!1})}dispose(){Object.values(this.filters).forEach(t=>{t&&"dispose"in t&&t.dispose()}),this.filters={grayscale:null,sepia:null,blur:null,invert:null},this.tempCanvas.width=1,this.tempCanvas.height=1,this.tempContext.clearRect(0,0,1,1),this.blurRadiusSlider&&this.blurRadiusSlider.removeEventListener("input",()=>{})}}class p{constructor(){this.filterManager=null,this.isProcessing=!1,this.animationFrameId=null,this.mediaRecorder=null,this.recordedChunks=[],this.isRecording=!1,this.videoElement=document.getElementById("videoElement"),this.canvasElement=document.getElementById("canvasElement"),this.canvasContext=this.canvasElement.getContext("2d",{willReadFrequently:!0}),this.captureButton=document.getElementById("captureButton"),this.recordButton=document.getElementById("recordButton"),this.captureButton.addEventListener("click",()=>this.capturePhoto()),this.recordButton.addEventListener("click",()=>this.toggleRecording()),this.startCamera(),window.addEventListener("beforeunload",()=>this.dispose())}capturePhoto(){if(this.isProcessing)return;this.isProcessing=!0;const t=document.createElement("canvas");t.width=this.canvasElement.width,t.height=this.canvasElement.height,t.getContext("2d").drawImage(this.canvasElement,0,0),t.toBlob(e=>{if(!e){console.error("Failed to create image blob"),this.isProcessing=!1;return}const i=URL.createObjectURL(e),r=document.createElement("a");r.href=i,r.download=`photo_${new Date().toISOString().replace(/[:.]/g,"-")}.png`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i),this.isProcessing=!1},"image/png")}toggleRecording(){this.isRecording?this.stopRecording():this.startRecording()}startRecording(){if(!this.videoElement.srcObject)return;const t=this.canvasElement.captureStream(30);this.mediaRecorder=new MediaRecorder(t,{mimeType:"video/webm;codecs=vp9"}),this.recordedChunks=[],this.mediaRecorder.ondataavailable=s=>{s.data.size>0&&this.recordedChunks.push(s.data)},this.mediaRecorder.onstop=()=>{const s=new Blob(this.recordedChunks,{type:"video/webm"}),e=URL.createObjectURL(s),i=document.createElement("a");i.href=e,i.download=`video_${new Date().toISOString().replace(/[:.]/g,"-")}.webm`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(e)},this.mediaRecorder.start(),this.isRecording=!0,this.recordButton.textContent="Stop Recording",this.recordButton.classList.add("recording")}stopRecording(){!this.mediaRecorder||!this.isRecording||(this.mediaRecorder.stop(),this.isRecording=!1,this.recordButton.textContent="Record Video",this.recordButton.classList.remove("recording"))}async startCamera(){try{this.videoElement.srcObject=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720}}}),this.videoElement.onloadedmetadata=()=>{this.canvasElement.width=this.videoElement.videoWidth,this.canvasElement.height=this.videoElement.videoHeight,this.filterManager=new f(this.canvasContext,this.canvasElement.width,this.canvasElement.height),this.startVideoProcessing()}}catch(t){console.error("Error accessing camera:",t),await this.handleCameraError(t)&&await this.startCamera()}}async handleCameraError(t){let s="Error accessing camera. ";if(t instanceof DOMException)switch(t.name){case"NotAllowedError":s+="Camera access was denied. Please grant camera permissions and try again.";break;case"NotFoundError":s+="No camera device found. Please connect a camera and try again.";break;case"NotReadableError":s+="Camera is already in use by another application. Please close other applications using the camera and try again.";break;default:s+="Please make sure you have granted camera permissions."}return confirm(s+`

Would you like to try again?`)}startVideoProcessing(){const t=()=>{this.isProcessing||(this.canvasContext.drawImage(this.videoElement,0,0),this.filterManager&&this.filterManager.applyFilters()),this.animationFrameId=requestAnimationFrame(t)};t()}dispose(){this.isRecording&&this.stopRecording(),this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.videoElement.srcObject&&(this.videoElement.srcObject.getTracks().forEach(s=>s.stop()),this.videoElement.srcObject=null),this.filterManager&&(this.filterManager.dispose(),this.filterManager=null),this.canvasContext.clearRect(0,0,this.canvasElement.width,this.canvasElement.height),this.canvasElement.width=1,this.canvasElement.height=1,this.captureButton.removeEventListener("click",()=>this.capturePhoto()),this.recordButton.removeEventListener("click",()=>this.toggleRecording())}}document.addEventListener("DOMContentLoaded",()=>{new p});
